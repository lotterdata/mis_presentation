---
title: "How to Lose Less Money in the Lottery"
author: "Stephen Penrice"
date: "Friday, June 19, 2015"
output: ioslides_presentation
---


## Real Goal: Understanding players' preferences

- Players prefer some numbers, such as family birthdays, 7's, etc.
- Direct data exist but are not public, so how can we document this? 
- Can back out by relating number of winners to numbers drawn.
- Number of winners is only informative if total number of players is known. 
- Otherwise we can model parimutuel prizes as a function of the numbers drawn.

## Games Discussed Here

* Texas Cash 5  
    + Players and lottery choose 5 integers from 1 to 37
    + Target prize for 3 matches is $10.00
    + Jan. 1, 2012 to June 12, 2015
* Pennsylvania Cash 5
    + Players and lottery choose 5 integers from 1 to 43
    + Target prize for 3 matches is $11.50
    + Jan. 1, 2012 to June 12, 2015
* New Jersey Cash 5  
    + Players and lottery choose 5 integers from 1 to 43
    + Target prize for 3 matches is $15.00 
    + Sept. 14, 2014 to June 12, 2015
  

## Random vs. Actual, Texas

```{r}
tx.actual <- read.table("tx_data\\tx_cash5.csv",header=TRUE,sep=",") 
sum(tx.actual$winners_3)/sum(tx.actual$sales)
dhyper(3,5,32,5)
```

## Random vs. Actual, Texas

```{r}
draws <- nrow(tx.actual)
pop <- 150000
prob <- dhyper(3,5,32,5)
pool <- sum(tx.actual$prize_3*tx.actual$winners_3)/sum(tx.actual$sales)

set.seed(12345)
sim.winners <- rpois(draws,pop*prob)
sim.prizes <- round(pop*pool/sim.winners)
sim.pct.win <- sim.winners/pop

actual.prizes <- tx.actual$prize_3
actual.pct.win  <- tx.actual$winners_3/tx.actual$sales
```

## Random vs. Actual, Texas

```{r, echo=FALSE}
par(mfrow=c(2,2))
hist(sim.prizes,xlab="",main="Simulated Prize Distribution")
hist(actual.prizes,xlab="",main="Actual Prize Distribution")
hist(round(sim.pct.win,4),xlab="",main="Simulated Win Percentage Distribution",
     breaks = c(0.007,0.008,0.009,0.01,0.011,0.012,0.013,0.014,0.015,0.016,0.017))
hist(round(actual.pct.win,4),xlab="",main="Actual Win Percentage Distribution",
     breaks = c(0.007,0.008,0.009,0.01,0.011,0.012,0.013,0.014,0.015,0.016,0.017))

rm(tx.actual)
```


## Random vs. Actual, Pennsylvania

```{r}
pa.actual <- read.table("pa_data\\pa_cash5.csv",header=TRUE,sep=",") 

draws <- nrow(pa.actual)
pop <- 400000
prob <- dhyper(3,5,38,5)
pool <- prob*mean(pa.actual$prize_3)

set.seed(54321)
sim.winners <- rpois(draws,pop*prob)
sim.prizes <- 0.5*round(2*pop*pool/sim.winners)

actual.prizes <- pa.actual$prize_3
```

## Random vs. Actual, Pennsylvania

```{r,echo=FALSE}
par(mfrow=c(1,2))
hist(sim.prizes,xlab="",main="Simulated Prize Distribution", xaxt="n")
axis(side = 1, at = c(11.0,11.5,12.0) )
hist(actual.prizes,xlab="",main="Actual Prize Distribution")
```


## Modeling When Sales Data Are Available

## Modeling Prize Amounts

## Validating on Recent Data

## Validating on New Jersey Data

## Comment on Deriving Player Choices

## Getting Data

## References

- My github repo   
<https://github.com/lotterdata/mis_presentation>  

- Number selection algorithm exploiting this idea  
<http://www.r-bloggers.com/picking-lotto-numbers/> 

- A recent article in a similar vein  
<http://www.r-bloggers.com/simple-data-science-to-maximize-return-on-lottery-investment/>
